{% extends 'index.html' %}
{%block title%} Cart {% endblock %}
{%block content%}
{% load mathfilters %}
{% load custom_tags %}
{% load static %}
    <section id="centers" class="section-padding top bg-gray centers">
    <div class="container">
        <div id="tabsJustifiedContent" class="tab-content">
            <div id="one" class="tab-pane animated fadeInRight active show">
                <div class="row">
                    {% if product_details.count == 0 %}
                     <div class=" col-lg-12 col-md-12 col-sm-12">
                    <div class="card">
                    <div class="card-header" style="background-color:white;">
                        <div class="row">
                            <div class="col-lg-4 col-md-4 col-sm-8 col-8">
                         <h4>Shopping Cart</h4>
                            </div>
                        </div>
                        </div>
                     <div class="card-body">
                     <div class="text-center">
                         <img src="{% static 'img/logo/emplty_cart.png'%}" width="300" height="250">
                     </div>
                          <div class="text-center"><br>
                         <a href="/products/"><button class="btn btn-success" style="cursor:pointer">Add Product</button></a>
                          </div>
                          </div>
                        </div>
                    </div>
                    {% else %}
                    <div class=" col-lg-8 col-md-12 col-sm-12">
                    <div class="card">
                    <div class="card-header" style="background-color:white;">
                        <div class="row">
                            <div class="col-lg-4 col-md-4 col-sm-8 col-8">
                         <h4>Shopping Cart</h4>
                            </div>
                            {%if product_details %}
                        <div class="col-lg-8 col-md-8 d-none  d-sm-block ">
                            <div class="float-right"><h5 style="margin-left:40px;">Price</h5><span style="font-size:14px;">Without Gst(for 1 item)</span></div>
                        </div>
                            {% endif %}
                        </div>
                        </div>
                        {%for product in product_details%}
                     <div class="card-body">

                     <div class="row">
                         <div class="col-md-3">
                             <img class="img-product" style="height:auto;" src="{{product.product.product_image.url}}" alt="{{product.product.product_name}}" title="{{product.product.product_name}}"/>
                         </div>
                          <div class="col-md-6">
                              <h5 style="margin-top: 12px;">{{product.product.product_name}}</h5>
                            <div class="description">
                            <p style="margin-top:-7px;">{{product.product.product_description}}</p>
                             </div>
                              <div class="d-block d-lg-none d-md-none d-sm-block"><br>
                               <h5><span style="font-size:18px">Price:  ₹</span>{{product.total_price}}.00</h5>
                              </div>
                              <br>
                                    <div class="row ml-2">
                                  <button class="btn btn-light ml-2" style="border-radius:20px;background-color: #c4dbf3;">
                                  Qty:
                              <select onchange="getValue(this.value,{{product.product_id}});" class="form-select id_quantity" aria-label="Default select example">

                                  {%if product.quantity == '1' %}
                                  <option selected disabled value="{{product.quantity}}">1</option>
                                  <option value="2">2</option>
                                  <option value="3">3</option>
                                  <option value="4">4</option>
                                  <option value="5">5</option>
                                  <option value="6">6</option>
                                  <option value="7">7</option>
                                  <option value="8">8</option>
                                  <option value="9">9</option>
                                  <option value="10">10</option>

                                  {% elif product.quantity == '2' %}
                                  <option value="1">1</option>
                                  <option selected disabled value="{{product.quantity}}">2</option>
                                  <option value="3">3</option>
                                  <option value="4">4</option>
                                  <option value="5">5</option>
                                  <option value="6">6</option>
                                  <option value="7">7</option>
                                  <option value="8">8</option>
                                  <option value="9">9</option>
                                  <option value="10">10</option>

                                   {% elif product.quantity == '3' %}
                                  <option value="1">1</option>
                                  <option value="2">2</option>
                                  <option selected disabled value="{{product.quantity}}">3</option>
                                  <option value="4">4</option>
                                  <option value="5">5</option>
                                  <option value="6">6</option>
                                  <option value="7">7</option>
                                  <option value="8">8</option>
                                  <option value="9">9</option>
                                  <option value="10">10</option>

                                   {% elif product.quantity == '4' %}
                                  <option value="1">1</option>
                                  <option value="2">2</option>
                                  <option value="3">3</option>
                                  <option selected disabled value="{{product.quantity}}">4</option>
                                  <option value="5">5</option>
                                  <option value="6">6</option>
                                  <option value="7">7</option>
                                  <option value="8">8</option>
                                  <option value="9">9</option>
                                  <option value="10">10</option>

                                   {% elif product.quantity == '5' %}
                                  <option value="1">1</option>
                                  <option value="2">2</option>
                                  <option value="3">3</option>
                                  <option value="4">4</option>
                                  <option selected disabled value="{{product.quantity}}" >5</option>
                                  <option value="6">6</option>
                                  <option value="7">7</option>
                                  <option value="8">8</option>
                                  <option value="9">9</option>
                                  <option value="10">10</option>

                                  {% elif product.quantity == '6' %}
                                  <option value="1">1</option>
                                  <option value="2">2</option>
                                  <option value="3">3</option>
                                  <option value="4">4</option>
                                  <option value="5" >5</option>
                                  <option selected disabled value="{{product.quantity}}">6</option>
                                  <option value="7">7</option>
                                  <option value="8">8</option>
                                  <option value="9">9</option>
                                  <option value="10">10</option>

                                  {% elif product.quantity == '7' %}
                                  <option value="1">1</option>
                                  <option value="2">2</option>
                                  <option value="3">3</option>
                                  <option value="4">4</option>
                                  <option value="5" >5</option>
                                  <option value="6" >6</option>
                                  <option selected disabled value="{{product.quantity}}">7</option>
                                  <option value="8">8</option>
                                  <option value="9">9</option>
                                  <option value="10">10</option>

                                  {% elif product.quantity == '8' %}
                                  <option value="1">1</option>
                                  <option value="2">2</option>
                                  <option value="3">3</option>
                                  <option value="4">4</option>
                                  <option value="5" >5</option>
                                  <option value="6" >6</option>
                                  <option value="7" >7</option>
                                  <option selected disabled value="{{product.quantity}}">8</option>
                                  <option value="9">9</option>
                                  <option value="10">10</option>

                                   {% elif product.quantity == '9' %}
                                  <option value="1">1</option>
                                  <option value="2">2</option>
                                  <option value="3">3</option>
                                  <option value="4">4</option>
                                  <option value="5" >5</option>
                                  <option value="6" >6</option>
                                  <option value="7" >7</option>
                                  <option value="8">8</option>
                                  <option selected disabled value="{{product.quantity}}">9</option>
                                  <option value="10">10</option>
                                   {% elif product.quantity == '10' %}
                                  <option value="1">1</option>
                                  <option value="2">2</option>
                                  <option value="3">3</option>
                                  <option value="4">4</option>
                                  <option value="5" >5</option>
                                  <option value="6" >6</option>
                                  <option value="7" >7</option>
                                  <option value="8">8</option>
                                  <option value="9">9</option>
                                  <option selected disabled value="{{product.quantity}}">10</option>

                                  {% else%}
                                  <option selected disabled value="{{product.quantity}}">{{product.quantity}}</option>
                                  <option value="1">1</option>
                                  <option value="2">2</option>
                                  <option value="3">3</option>
                                  <option value="4">4</option>
                                  <option value="5" >5</option>
                                  <option value="6" >6</option>
                                  <option value="7" >7</option>
                                  <option value="8">8</option>
                                  <option value="9">9</option>
                                  <option value="10">10</option>
                                  {% endif %}
                                  <option value="11">10+</option>
                                    </select>
                                  </button>
                                         <button class="btn btn-danger ml-4" style="border-radius:20px;">
                                      <a style="color:white;" href="/delete-item/{{product.product_id}}/">Delete
                                  <i class="fa fa-trash" aria-hidden="true" style="padding:0;
                margin:0; width:15px; height:0; font-size: 18px;"></i></a></button>
                                    </div>
                              <input class="form-control m-4" style="width:120px; display:none" type="number"
                                     placeholder="Enter QTY " name="input_qty" id="{{product.product_id}}" onkeyup="ChangeQty(this.value,{{product.product_id}})"/>
<!--                              <div class="row ml-2">-->
<!--                                  <button class="btn btn-warning"style="border-radius:20px;">-->
<!--                                      <a style="color:black;" href="/buy-item$1/{{product.product_id}}/">-->
<!--                                          Buy Now</a></button>-->
<!--                              </div>-->
                         </div>
                          <div class="col-md-3 d-none d-sm-block text-center">
                              <h5><span style="font-size:18px">₹</span>{{product.product.product_price}}.00</h5></div>
                     </div>
                        </div>
                        <hr>

                        {%endfor%}


                        </div>
                    </div>
                    {% endif %}
                    {% if product_details.count != 0 %}
                      <div class="col-lg-4 col-md-12">
                <div class="card checkout_padding">
                   <div class="card-header" style="background-color:white">
                       <h5>Payment Details</h5>
                   </div>
                   <div class="card-body">
                       <div class="row">
                           <div class="col-md-6 col-sm-6 col-6 row" style="padding-left:28px;">
                               <h6>Price</h6><h6>(</h6><h6 id="qty">{{total_qty}}</h6><h6>)</h6>
                           </div>
                            <div class="col-md-6 col-sm-6 col-6 row" style="padding-left:42px;">
                              <h6>₹</h6><h6 id="price_without_gst">{{price_without_gst}}</h6><h6>.00</h6>
                           </div>
                       </div><hr>
                        <div class="row">
                           <div class="col-md-6 col-sm-6 col-6">
                               <h6>GST amt</h6>
                           </div>
                            <div class="row col-md-6 col-sm-6 col-6">
                              <h6>₹</h6><h6 id="gst">{{total_gst}}</h6><h6>.00</h6>
                           </div>
                       </div><hr>
                        <div class="row">
                           <div class="col-md-6 col-sm-6 col-6">
                               <h6>Total Price</h6>
                           </div>
                            <div class="col-md-6 col-sm-6 col-6 row">
                              <h6>₹</h6><h6 id="total_price">{{net_price}}</h6><h6>.00</h6>
                           </div>
                       </div>
                    <div class="float-right">

                       <a style="color:white;" href="/buy-item$1/"><button style="cursor:pointer" class="btn btn-primary"  id="rzp-button1">
                           Checkout</button></a>
                    </div><br>

                   </div>
                </div>
            </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    </section>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script>

    function getValue(Qty,product_id)
    {
      var element=document.getElementById(product_id);
       if (Qty==11){
       element.style.display='block';
       }
       else{
       element.style.display='none';
      var url = '/quantity-change/';
      $.ajax({
        url: url,
        type:'post',
        data: {
          'quantity': Qty,
          'id' : product_id,
          'csrfmiddlewaretoken':"{{csrf_token}}"
        },
        success: function (data) {
        document.getElementById("price_without_gst").innerHTML = data.price_without_gst
        document.getElementById("gst").innerHTML = data.total_gst
        document.getElementById("total_price").innerHTML = data.net_price
        document.getElementById("qty").innerHTML = data.qty
        console.log(data)
        }
      });
}
    }

function ChangeQty(Qty,product_id)
    {
    if(Qty>0){
     var url = '/quantity-change/';
      $.ajax({
        url: url,
        type:'post',
        data: {
          'quantity': Qty,
          'id' : product_id,
          'csrfmiddlewaretoken':"{{csrf_token}}"
        },
        success: function (data) {
        document.getElementById("price_without_gst").innerHTML = data.price_without_gst
        document.getElementById("gst").innerHTML = data.total_gst
        document.getElementById("total_price").innerHTML = data.net_price
        document.getElementById("qty").innerHTML = data.qty
        console.log(data)
        }
      });
    }
}

</script>

{% endblock%}